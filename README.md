# Azure TensorFlow Cloud Starter ğŸš€

![Redaction Status](https://img.shields.io/badge/REDACTED-no%20secrets%2C%20IPs%2C%20or%20tenant%20info-brightgreen)
[![CI](https://img.shields.io/badge/CI-ready-blue)](#)

A clean, production-ready template to run **TensorFlow** training/inference on **Microsoft Azure** using containerized jobs.  
Designed to be simple, auditable, and cloud-agnostic in structure â€” inspired by the ethos of [`tensorflow/cloud`](https://github.com/tensorflow/cloud) while targeting Azure services.

> âœ… **Redaction notice:** This repository contains **no secrets, IP addresses, tenant IDs, or organization identifiers**. All parameters use safe placeholders (e.g., `<SUBSCRIPTION_ID>`, `<ACR_NAME>`).

---

## ğŸ§­ What you get

- **Professional docs**: RUNBOOK, ARCHITECTURE, SECURITY, CUTOVER & ROLLBACK checklists.
- **Automation-ready scripts**: Bash + PowerShell to provision Azure resources and submit jobs.
- **Manifests**: Azure ML job YAML and Kubernetes Job for AKS.
- **Clean `.gitignore`** and consistent Markdown formatting.

---

## ğŸ§© Architecture (at a glance)

```mermaid
flowchart LR
  Dev["Developer Workstation"] -->|git push / az| ACR["Azure Container Registry"]
  ACR --> AKS["AKS Cluster"]
  ACR --> AML["Azure ML Workspace"]

  subgraph Training_Paths
    AKS -->|kubectl apply| KJob["Kubernetes Job<br/>(tf:python main.py)"]
    AML -->|az ml job create| AMLJob["Azure ML Job<br/>(environment: docker)"]
  end

  Storage["Blob Storage"] <--> AMLJob
  Storage <--> KJob
  Dev -->|monitor| Logs["Azure Monitor / K8s Logs"]
```

Two supported execution paths:
1. **Azure ML (recommended)** for orchestration, tracking, and managed compute.
2. **AKS Kubernetes Job** for simple, direct container execution.

---

## ğŸ” Lifecycle Stages

1. **Plan** â†’ pick AML vs AKS, decide image base, set quotas.
2. **Build** â†’ containerize your TF code (`Dockerfile`), version tag, push to ACR.
3. **Provision** â†’ create ACR, AKS or AML workspace (scripts provided).
4. **Configure** â†’ set env vars, dataset mounts, secrets in Key Vault (not in git).
5. **Execute** â†’ submit job (AML or AKS).
6. **Observe** â†’ watch logs/metrics; capture artifacts.
7. **Cutover** â†’ promote model/image to prod tags.
8. **Rollback** â†’ revert to previous tag / job definition.
9. **Harden** â†’ apply Security.md items (RBAC, private endpoints, policies).

---

## ğŸƒ Quickstart

```bash
# 1) Configure your session
az login
az account set --subscription <SUBSCRIPTION_ID>

# 2) Create core resources (ACR + AKS minimal) - bash
./scripts/azure/create-acr-aks.sh

# 3) Build and push your TensorFlow image
./scripts/docker_build_and_push.sh

# 4a) Submit via Azure ML
az extension add -n ml -y
./scripts/azureml/submit-job.sh

# 4b) Or submit to AKS with kubectl
./scripts/kubernetes/submit-job.sh
```

> â„¹ï¸ Replace placeholders (`<RESOURCE_GROUP>`, `<ACR_NAME>`, `<AKS_NAME>`, etc.) in `configs/sample.env` or export them in your shell.

---

## ğŸ›¡ï¸ Redaction badge & statement

- Badge above is generated by shields.io to indicate this repo is intentionally **redacted**.
- We commit **no** credentials, keys, IPs, tenant or subscription IDs. Use **Azure Key Vault** or environment variables.
- Example secrets to **avoid** committing: service principals, SAS tokens, kubeconfigs, AML datastore keys.

---

## ğŸ“š Documentation Map

- [`RUNBOOK.md`](./RUNBOOK.md) â€“ step-by-step operations
- [`docs/OVERVIEW.md`](./docs/OVERVIEW.md) â€“ concise intro
- [`docs/ARCHITECTURE.md`](./docs/ARCHITECTURE.md) â€“ diagrams + components
- [`docs/SECURITY.md`](./docs/SECURITY.md) â€“ guardrails & policies
- [`docs/CUTOVER_CHECKLIST.md`](./docs/CUTOVER_CHECKLIST.md) â€“ promote to prod
- [`docs/ROLLBACK.md`](./docs/ROLLBACK.md) â€“ safe revert procedure

---

## ğŸ“¦ Contents

```
.
â”œâ”€â”€ README.md
â”œâ”€â”€ RUNBOOK.md
â”œâ”€â”€ .gitignore
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ sample.env
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ azure/
â”‚   â”‚   â”œâ”€â”€ create-acr-aks.sh
â”‚   â”‚   â””â”€â”€ create-acr-aks.ps1
â”‚   â”œâ”€â”€ azureml/
â”‚   â”‚   â””â”€â”€ submit-job.sh
â”‚   â”œâ”€â”€ kubernetes/
â”‚   â”‚   â””â”€â”€ submit-job.sh
â”‚   â””â”€â”€ docker_build_and_push.sh
â””â”€â”€ manifests/
    â”œâ”€â”€ azureml/
    â”‚   â””â”€â”€ tf-train-job.yml
    â””â”€â”€ kubernetes/
        â””â”€â”€ tf-job.yaml
```

---

## ğŸ§ª Local development

- Create a Python venv, install TensorFlow and your project deps.
- Develop your training script (e.g., `train.py`) and mount it into the container or bake into the image.
- Use small test epochs/steps locally; scale on cloud.

---

## ğŸ“„ License & attribution

Use with your preferred license. Inspired by ideas from the TensorFlow ecosystem; this starter targets **Azure** workflows.
